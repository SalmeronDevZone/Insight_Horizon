{"FileFormatVersion":6,"ActivityID":"2EA46CB7-BF03-4F1F-9512-715812B219F2","StorageEngineDuration":2593,"StorageEngineNetParallelDuration":2593,"FormulaEngineDuration":2921,"StorageEngineEvents":[{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n\t'dimCalendario'[fecha],\r\n\tCOUNT () \r\nFROM 'dimCalendario';\r\n","TextData":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n[Data Date (16)].[Date (65)] AS [Data Date (16)$Date (65)],\r\nCOUNT()\r\nFROM [Data Date (16)];\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":1,"IsInternalEvent":true,"StartTime":"2024-04-04T13:26:26.723333+02:00","EndTime":"2024-04-04T13:26:26.723333+02:00","StartOffsetMs":0,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimCalendario'[fecha]\r\nFROM 'dimCalendario';\r\n\r\n\r\nEstimated size: rows = 4.021  bytes = 32.168\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Date (16)].[Date (65)] AS [Data Date (16)$Date (65)]\r\nFROM [Data Date (16)];\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 4021, 32168]\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":2,"EstimatedRows":4021,"EstimatedKBytes":32,"StartTime":"2024-04-04T13:26:26.723333+02:00","EndTime":"2024-04-04T13:26:26.723333+02:00","StartOffsetMs":0,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"C64\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente],\r\n\t'factPedidos'[ID_cliente]\r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimClientes'\r\n\t\tON 'factPedidos'[ID_cliente]='dimClientes'[ID_cliente]\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] INB ( 43525.000000, 43526.000000, 43527.000000, 43528.000000, 43529.000000, 43530.000000, 43531.000000, 43532.000000, 43533.000000, 43534.000000..[245 total values, not all displayed] ) ;\r\n","TextData":"SET DC_KIND=\"C64\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)], [Data Orders (25)].[CustomerKey (96)] AS [Data Orders (25)$CustomerKey (96)]\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Customer (13)] ON [Data Orders (25)].[CustomerKey (96)]=[Data Customer (13)].[CustomerKey (44)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] INB (43525.000000, 43526.000000, 43527.000000, 43528.000000, 43529.000000, 43530.000000, 43531.000000, 43532.000000, 43533.000000, 43534.000000...[245 total values, not all displayed]);\r\n","Duration":1153,"NetParallelDuration":1153,"CpuTime":7469,"CpuFactor":6.4778837814397221,"RowNumber":3,"IsInternalEvent":true,"StartTime":"2024-04-04T13:26:26.726667+02:00","EndTime":"2024-04-04T13:26:27.88+02:00","StartOffsetMs":3,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente],\r\n\t'factPedidos'[ID_cliente]\r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimClientes'\r\n\t\tON 'factPedidos'[ID_cliente]='dimClientes'[ID_cliente]\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] IN ( 43553.000000, 43594.000000, 43635.000000, 43676.000000, 43717.000000, 43758.000000, 43526.000000, 43567.000000, 43608.000000, 43622.000000..[245 total values, not all displayed] ) ;\r\n\r\n\r\nEstimated size: rows = 1.531.809  bytes = 12.254.472\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)], [Data Orders (25)].[CustomerKey (96)] AS [Data Orders (25)$CustomerKey (96)]\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Customer (13)] ON [Data Orders (25)].[CustomerKey (96)]=[Data Customer (13)].[CustomerKey (44)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] IN (43553.000000, 43594.000000, 43635.000000, 43676.000000, 43717.000000, 43758.000000, 43526.000000, 43567.000000, 43608.000000, 43622.000000...[245 total values, not all displayed]);\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 1531809, 12254472]\r\n","Duration":1155,"NetParallelDuration":1155,"CpuTime":7469,"CpuFactor":6.4666666666666668,"RowNumber":4,"EstimatedRows":1531809,"EstimatedKBytes":11968,"StartTime":"2024-04-04T13:26:26.726667+02:00","EndTime":"2024-04-04T13:26:27.88+02:00","StartOffsetMs":3,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"C64\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente],\r\n\t'factPedidos'[ID_cliente]\r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimClientes'\r\n\t\tON 'factPedidos'[ID_cliente]='dimClientes'[ID_cliente]\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] INB ( 43770.000000, 43771.000000, 43772.000000, 43773.000000, 43774.000000, 43775.000000, 43776.000000, 43777.000000, 43778.000000, 43779.000000..[61 total values, not all displayed] ) ;\r\n","TextData":"SET DC_KIND=\"C64\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)], [Data Orders (25)].[CustomerKey (96)] AS [Data Orders (25)$CustomerKey (96)]\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Customer (13)] ON [Data Orders (25)].[CustomerKey (96)]=[Data Customer (13)].[CustomerKey (44)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] INB (43770.000000, 43771.000000, 43772.000000, 43773.000000, 43774.000000, 43775.000000, 43776.000000, 43777.000000, 43778.000000, 43779.000000...[61 total values, not all displayed]);\r\n","Duration":627,"NetParallelDuration":627,"CpuTime":1469,"CpuFactor":2.3429027113237639,"RowNumber":5,"IsInternalEvent":true,"StartTime":"2024-04-04T13:26:28.21+02:00","EndTime":"2024-04-04T13:26:28.833333+02:00","StartOffsetMs":1487,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente],\r\n\t'factPedidos'[ID_cliente]\r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimClientes'\r\n\t\tON 'factPedidos'[ID_cliente]='dimClientes'[ID_cliente]\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] IN ( 43772.000000, 43786.000000, 43799.000000, 43813.000000, 43827.000000, 43773.000000, 43800.000000, 43814.000000, 43774.000000, 43787.000000..[61 total values, not all displayed] ) ;\r\n\r\n\r\nEstimated size: rows = 1.252.695  bytes = 10.021.560\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)], [Data Orders (25)].[CustomerKey (96)] AS [Data Orders (25)$CustomerKey (96)]\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Customer (13)] ON [Data Orders (25)].[CustomerKey (96)]=[Data Customer (13)].[CustomerKey (44)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] IN (43772.000000, 43786.000000, 43799.000000, 43813.000000, 43827.000000, 43773.000000, 43800.000000, 43814.000000, 43774.000000, 43787.000000...[61 total values, not all displayed]);\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 1252695, 10021560]\r\n","Duration":628,"NetParallelDuration":628,"CpuTime":1469,"CpuFactor":2.339171974522293,"RowNumber":6,"EstimatedRows":1252695,"EstimatedKBytes":9787,"StartTime":"2024-04-04T13:26:28.206667+02:00","EndTime":"2024-04-04T13:26:28.833333+02:00","StartOffsetMs":1483,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"C64\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente],\r\n\t'factPedidos'[ID_cliente]\r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimClientes'\r\n\t\tON 'factPedidos'[ID_cliente]='dimClientes'[ID_cliente]\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] INB ( 43831.000000, 43832.000000, 43833.000000, 43834.000000, 43835.000000, 43836.000000, 43837.000000, 43838.000000, 43839.000000, 43840.000000..[60 total values, not all displayed] ) ;\r\n","TextData":"SET DC_KIND=\"C64\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)], [Data Orders (25)].[CustomerKey (96)] AS [Data Orders (25)$CustomerKey (96)]\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Customer (13)] ON [Data Orders (25)].[CustomerKey (96)]=[Data Customer (13)].[CustomerKey (44)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] INB (43831.000000, 43832.000000, 43833.000000, 43834.000000, 43835.000000, 43836.000000, 43837.000000, 43838.000000, 43839.000000, 43840.000000...[60 total values, not all displayed]);\r\n","Duration":587,"NetParallelDuration":587,"CpuTime":1703,"CpuFactor":2.9011925042589439,"RowNumber":7,"IsInternalEvent":true,"StartTime":"2024-04-04T13:26:29.06+02:00","EndTime":"2024-04-04T13:26:29.646667+02:00","StartOffsetMs":2337,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente],\r\n\t'factPedidos'[ID_cliente]\r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimClientes'\r\n\t\tON 'factPedidos'[ID_cliente]='dimClientes'[ID_cliente]\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] IN ( 43840.000000, 43854.000000, 43868.000000, 43881.000000, 43841.000000, 43855.000000, 43882.000000, 43842.000000, 43856.000000, 43869.000000..[60 total values, not all displayed] ) ;\r\n\r\n\r\nEstimated size: rows = 1.271.884  bytes = 10.175.072\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)], [Data Orders (25)].[CustomerKey (96)] AS [Data Orders (25)$CustomerKey (96)]\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Customer (13)] ON [Data Orders (25)].[CustomerKey (96)]=[Data Customer (13)].[CustomerKey (44)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] IN (43840.000000, 43854.000000, 43868.000000, 43881.000000, 43841.000000, 43855.000000, 43882.000000, 43842.000000, 43856.000000, 43869.000000...[60 total values, not all displayed]);\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 1271884, 10175072]\r\n","Duration":587,"NetParallelDuration":587,"CpuTime":1703,"CpuFactor":2.9011925042589439,"RowNumber":8,"EstimatedRows":1271884,"EstimatedKBytes":9937,"StartTime":"2024-04-04T13:26:29.06+02:00","EndTime":"2024-04-04T13:26:29.646667+02:00","StartOffsetMs":2337,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"C32\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente]\r\nFROM 'dimClientes';\r\n","TextData":"SET DC_KIND=\"C32\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)]\r\nFROM [Data Customer (13)];\r\n","Duration":223,"NetParallelDuration":223,"CpuTime":219,"CpuFactor":0.98206278026905824,"RowNumber":9,"IsInternalEvent":true,"StartTime":"2024-04-04T13:26:29.896667+02:00","EndTime":"2024-04-04T13:26:30.12+02:00","StartOffsetMs":3173,"TotalQueryDuration":5514},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimClientes'[ID_cliente]\r\nFROM 'dimClientes';\r\n\r\n\r\nEstimated size: rows = 1.868.084  bytes = 7.472.336\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Customer (13)].[CustomerKey (44)] AS [Data Customer (13)$CustomerKey (44)]\r\nFROM [Data Customer (13)];\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 1868084, 7472336]\r\n","Duration":223,"NetParallelDuration":223,"CpuTime":219,"CpuFactor":0.98206278026905824,"RowNumber":10,"EstimatedRows":1868084,"EstimatedKBytes":7298,"StartTime":"2024-04-04T13:26:29.896667+02:00","EndTime":"2024-04-04T13:26:30.12+02:00","StartOffsetMs":3173,"TotalQueryDuration":5514}],"StorageEngineCpu":10860,"TotalDuration":5514,"StorageEngineQueryCount":5,"TotalCpuDuration":13703,"QueryEndDateTime":"2024-04-04T13:26:32.236667+02:00","QueryStartDateTime":"2024-04-04T13:26:26.723333+02:00","CommandText":"EVALUATE\n{\n/*--------------------------------------------------------------------\nMedida para calcular el N.ยบ de clientes considerados nuevos.\n--------------------------------------------------------------------*/\nVAR _uFra = DATE(2020, 3, 3)\nVAR _iAnt = DATE(2019, 3, 1)\nVAR _fRec = EOMONTH( _uFra, -1 )\nVAR _iRec = EOMONTH( _uFra, -3 ) +1\nVAR _iInt = EOMONTH( _iRec, -3 ) +1\n\nVAR _tbl = \tADDCOLUMNS(\n                VALUES(dimClientes[ID_cliente]),\n                \"@Antiguo\", CALCULATE(\n                                --COUNTROWS(\n                                    VALUES(factPedidos[ID_cliente]),\n                                --),\n                                DATESBETWEEN(\n                                    dimCalendario[fecha],\n                                    _iAnt,\n                                    --BLANK(),\n                                    _iInt -1\n                                )\n                            ),\n                            \n                \"@Interm\",  CALCULATE(\n                                --COUNTROWS(\n                                    VALUES(factPedidos[ID_cliente]),\n                                --),\n                                DATESBETWEEN(\n                                    dimCalendario[fecha],\n                                    _iInt,\n                                    _iRec -1\n                                )\n                            ),\n                \"@Recien\", \tCALCULATE(\n                                --COUNTROWS(\n                                    VALUES(factPedidos[ID_cliente]),\n                                --),\n                                DATESBETWEEN(\n                                    dimCalendario[fecha],\n                                    _iRec,\n                                    _fRec\n                                )\n                            )\n            )\n\nVAR _nuevos =\t\tFILTER(\n\t\t\t\t\t\t_tbl,\n\t\t\t\t\t\t[@Antiguo] = 0 &&\n\t\t\t\t\t\t[@Interm] = 0 &&\n\t\t\t\t\t\t[@Recien] > 0\n\t\t\t\t\t)\n                    \nVAR _result = \t\tCOUNTROWS(_nuevos)\n\nRETURN\t\t\t\t_result\n}","TimelineTotalDuration":5514}