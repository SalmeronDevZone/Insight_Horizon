{"FileFormatVersion":6,"ActivityID":"B4E8B647-6622-4FB5-82F9-88986B8DE959","StorageEngineDuration":40,"StorageEngineNetParallelDuration":40,"FormulaEngineDuration":88,"StorageEngineEvents":[{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n\tSUM ( 'factPedidos'[ud] ),\r\n\tCOUNT () \r\nFROM 'factPedidos'\r\nWHERE\r\n\t ( PFCASTCOALESCE ( 'factPedidos'[ud] AS INT ) < COALESCE ( 0 ) ) ;\r\n","TextData":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\nSUM([Data Orders (25)].[Quantity (2946)]) AS [$Measure0], COUNT()\r\nFROM [Data Orders (25)]\r\nWHERE\r\n\t(PFCASTCOALESCE( [Data Orders (25)].[Quantity (2946)] AS  INT ) < COALESCE(0));\r\n","Duration":17,"NetParallelDuration":17,"CpuTime":0,"RowNumber":1,"IsInternalEvent":true,"StartTime":"2024-03-24T12:18:32.083333+01:00","EndTime":"2024-03-24T12:18:32.1+01:00","StartOffsetMs":0,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\tSUM ( 'factPedidos'[ud] )\r\nFROM 'factPedidos'\r\nWHERE\r\n\t ( PFCASTCOALESCE ( 'factPedidos'[ud] AS INT ) < COALESCE ( 0 ) ) ;\r\n\r\n\r\nEstimated size: rows = 1  bytes = 16\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\nSUM([Data Orders (25)].[Quantity (2946)]) AS [$Measure0]\r\nFROM [Data Orders (25)]\r\nWHERE\r\n\t(PFCASTCOALESCE( [Data Orders (25)].[Quantity (2946)] AS  INT ) < COALESCE(0));\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 1, 16]\r\n","Duration":17,"NetParallelDuration":17,"CpuTime":0,"RowNumber":2,"EstimatedRows":1,"EstimatedKBytes":1,"StartTime":"2024-03-24T12:18:32.083333+01:00","EndTime":"2024-03-24T12:18:32.1+01:00","StartOffsetMs":0,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n\t'dimCalendario'[fecha],\r\n\tCOUNT () \r\nFROM 'dimCalendario';\r\n","TextData":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n[Data Date (16)].[Date (65)] AS [Data Date (16)$Date (65)],\r\nCOUNT()\r\nFROM [Data Date (16)];\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":3,"IsInternalEvent":true,"StartTime":"2024-03-24T12:18:32.103333+01:00","EndTime":"2024-03-24T12:18:32.103333+01:00","StartOffsetMs":20,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimCalendario'[fecha]\r\nFROM 'dimCalendario';\r\n\r\n\r\nEstimated size: rows = 4.021  bytes = 32.168\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Date (16)].[Date (65)] AS [Data Date (16)$Date (65)]\r\nFROM [Data Date (16)];\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 4021, 32168]\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":4,"EstimatedRows":4021,"EstimatedKBytes":32,"StartTime":"2024-03-24T12:18:32.103333+01:00","EndTime":"2024-03-24T12:18:32.103333+01:00","StartOffsetMs":20,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n\t'dimCalendario'[añoMes],\r\n\tCOUNT () \r\nFROM 'dimCalendario';\r\n","TextData":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n[Data Date (16)].[añoMes (4750)] AS [Data Date (16)$añoMes (4750)],\r\nCOUNT()\r\nFROM [Data Date (16)];\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":5,"IsInternalEvent":true,"StartTime":"2024-03-24T12:18:32.103333+01:00","EndTime":"2024-03-24T12:18:32.103333+01:00","StartOffsetMs":20,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimCalendario'[añoMes]\r\nFROM 'dimCalendario';\r\n\r\n\r\nEstimated size: rows = 135  bytes = 1.080\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Date (16)].[añoMes (4750)] AS [Data Date (16)$añoMes (4750)]\r\nFROM [Data Date (16)];\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 135, 1080]\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":6,"EstimatedRows":135,"EstimatedKBytes":2,"StartTime":"2024-03-24T12:18:32.103333+01:00","EndTime":"2024-03-24T12:18:32.103333+01:00","StartOffsetMs":20,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n\t'dimCalendario'[añoMes],\r\n\tMAX ( 'dimCalendario'[fecha] ),\r\n\tCOUNT () \r\nFROM 'dimCalendario';\r\n","TextData":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n[Data Date (16)].[añoMes (4750)] AS [Data Date (16)$añoMes (4750)],\r\nMAX([Data Date (16)].[Date (65)]) AS [$Measure0], COUNT()\r\nFROM [Data Date (16)];\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":7,"IsInternalEvent":true,"StartTime":"2024-03-24T12:18:32.103333+01:00","EndTime":"2024-03-24T12:18:32.103333+01:00","StartOffsetMs":20,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimCalendario'[añoMes],\r\n\tMAX ( 'dimCalendario'[fecha] )\r\nFROM 'dimCalendario';\r\n\r\n\r\nEstimated size: rows = 135  bytes = 2.160\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Date (16)].[añoMes (4750)] AS [Data Date (16)$añoMes (4750)],\r\nMAX([Data Date (16)].[Date (65)]) AS [$Measure0]\r\nFROM [Data Date (16)];\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 135, 2160]\r\n","Duration":0,"NetParallelDuration":0,"CpuTime":0,"RowNumber":8,"EstimatedRows":135,"EstimatedKBytes":3,"StartTime":"2024-03-24T12:18:32.103333+01:00","EndTime":"2024-03-24T12:18:32.103333+01:00","StartOffsetMs":20,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScanInternal","Query":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n\t'dimCalendario'[fecha],\r\n\tSUM ( 'factPedidos'[ud] ),\r\n\tCOUNT () \r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] INB ( null, 40179.000000, 40180.000000, 40181.000000, 40182.000000, 40183.000000, 40184.000000, 40185.000000, 40186.000000, 40187.000000..[4.019 total values, not all displayed] ) ;\r\n","TextData":"SET DC_KIND=\"DENSE\";\r\nSELECT\r\n[Data Date (16)].[Date (65)] AS [Data Date (16)$Date (65)],\r\nSUM([Data Orders (25)].[Quantity (2946)]) AS [$Measure0], COUNT()\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] INB (null, 40179.000000, 40180.000000, 40181.000000, 40182.000000, 40183.000000, 40184.000000, 40185.000000, 40186.000000, 40187.000000...[4019 total values, not all displayed]);\r\n","Duration":23,"NetParallelDuration":23,"CpuTime":78,"CpuFactor":3.3913043478260869,"RowNumber":9,"IsInternalEvent":true,"StartTime":"2024-03-24T12:18:32.163333+01:00","EndTime":"2024-03-24T12:18:32.186667+01:00","StartOffsetMs":80,"TotalQueryDuration":128},{"Class":"VertiPaqSEQueryEnd","Subclass":"VertiPaqScan","Query":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n\t'dimCalendario'[fecha],\r\n\tSUM ( 'factPedidos'[ud] )\r\nFROM 'factPedidos'\r\n\tLEFT OUTER JOIN 'dimCalendario'\r\n\t\tON 'factPedidos'[fechaPedido]='dimCalendario'[fecha]\r\nWHERE\r\n\t'dimCalendario'[fecha] IN ( 41133.000000, 42090.000000, 42131.000000, 43088.000000, 43129.000000, 44086.000000, 44127.000000, 41051.000000, 41092.000000, 42049.000000..[4.019 total values, not all displayed] ) ;\r\n\r\n\r\nEstimated size: rows = 4.021  bytes = 64.336\r\n","TextData":"SET DC_KIND=\"AUTO\";\r\nSELECT\r\n[Data Date (16)].[Date (65)] AS [Data Date (16)$Date (65)],\r\nSUM([Data Orders (25)].[Quantity (2946)]) AS [$Measure0]\r\nFROM [Data Orders (25)]\r\n\tLEFT OUTER JOIN [Data Date (16)] ON [Data Orders (25)].[Order Date (98)]=[Data Date (16)].[Date (65)]\r\nWHERE\r\n\t[Data Date (16)].[Date (65)] IN (41133.000000, 42090.000000, 42131.000000, 43088.000000, 43129.000000, 44086.000000, 44127.000000, 41051.000000, 41092.000000, 42049.000000...[4019 total values, not all displayed]);\r\n\r\n\r\n[Estimated size (volume, marshalling bytes): 4021, 64336]\r\n","Duration":23,"NetParallelDuration":23,"CpuTime":78,"CpuFactor":3.3913043478260869,"RowNumber":10,"EstimatedRows":4021,"EstimatedKBytes":63,"StartTime":"2024-03-24T12:18:32.163333+01:00","EndTime":"2024-03-24T12:18:32.186667+01:00","StartOffsetMs":80,"TotalQueryDuration":128}],"StorageEngineCpu":78,"TotalDuration":128,"StorageEngineQueryCount":5,"TotalCpuDuration":141,"QueryEndDateTime":"2024-03-24T12:18:32.21+01:00","QueryStartDateTime":"2024-03-24T12:18:32.083333+01:00","CommandText":"EVALUATE\n{\n--Las salidas son Ud que figuran en negativo en la tabla origen------\nVAR _salidas =      CALCULATE(\n                        SUM( factPedidos[ud] )* -1,\n                        factPedidos[ud] < 0\n                    )\n\n--Creación de tabla virtual con meses y ud acumuladas----------------\nVAR _tabla =    ADDCOLUMNS(\n                    SUMMARIZE(\n                        dimCalendario,\n                        dimCalendario[AñoMes]\n                    ),\n                    \"@Ud Acum\",\n                    CALCULATE(\n                        VAR _diaMax = MAX(dimCalendario[fecha])\n                        RETURN\n                        CALCULATE(\n                            SUM(factPedidos[ud]),\n                            dimCalendario[fecha] <= _diaMax\n                        )\n                    )\n                )\n\n--Determinación del Nº de meses que tienen datos---------------------\nVAR _conDat =   FILTER(\n                    _tabla,\n                    [@Ud Acum] > 0\n                )\nVAR _nMeses =   COUNTROWS(_conDat)\n\n--Creación del promedio sobre las cifras acumuladas------------------\nVAR _totAcum =  SUMX(_tabla, [@Ud Acum])\nVAR _promAcum = DIVIDE(_totAcum, _nMeses)\n\n--Cálculo final------------------------------------------------------\nVAR _result =   DIVIDE(_salidas, _promAcum)\n\nRETURN          _result\n}","TimelineTotalDuration":128}